# ë¬¸ì„œ ì²˜ë¦¬ ìë™í™” API (FastAPI)

ì—‘ì…€, ì´ë¯¸ì§€, PDF íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ í•µì‹¬ ì •ë³´ë¥¼ ì¶”ì¶œí•˜ê³  êµ¬ì¡°í™”ëœ ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•˜ëŠ” **FastAPI ê¸°ë°˜** í”„ë¡œë•ì…˜ ë ˆë”” API ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.

## ğŸš€ ì£¼ìš” íŠ¹ì§•

### FastAPIì˜ ì¥ì 
- **ìë™ OpenAPI ë¬¸ì„œ ìƒì„±**: `/docs`ì—ì„œ Swagger UI, `/redoc`ì—ì„œ ReDoc ì œê³µ
- **ë„¤ì´í‹°ë¸Œ async/await ì§€ì›**: ë¹„ë™ê¸° ì²˜ë¦¬ë¡œ ë†’ì€ ë™ì‹œì„± ì²˜ë¦¬ ëŠ¥ë ¥
- **Pydantic ê¸°ë°˜ ê²€ì¦**: íƒ€ì… íŒíŒ…ìœ¼ë¡œ ìë™ ìš”ì²­/ì‘ë‹µ ê²€ì¦
- **ë¹ ë¥¸ ì„±ëŠ¥**: Starlette ê¸°ë°˜ìœ¼ë¡œ Djangoë³´ë‹¤ 5-10ë°° ë¹ ë¥¸ ì„±ëŠ¥
- **ìë™ íƒ€ì… ì²´í¬**: IDE ìë™ì™„ì„± ë° íƒ€ì… ì•ˆì •ì„±

### í•µì‹¬ ê¸°ëŠ¥
- ğŸ“¤ **íŒŒì¼ ì—…ë¡œë“œ/ë‹¤ìš´ë¡œë“œ**: Excel, ì´ë¯¸ì§€, PDF íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ ì§€ì›
- ğŸ” **JWT ì¸ì¦**: OAuth2 Bearer í† í° ê¸°ë°˜ ë³´ì•ˆ
- âš™ï¸ **ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬**: Celeryë¥¼ í™œìš©í•œ ë¹„ë™ê¸° ë¬¸ì„œ ì²˜ë¦¬
- ğŸ“Š **ì •ë³´ ì¶”ì¶œ**: ì—…ë¡œë“œëœ ë¬¸ì„œì—ì„œ í•µì‹¬ ì •ë³´ ìë™ ì¶”ì¶œ
- ğŸ“ **ë¦¬í¬íŠ¸ ìƒì„±**: ì¶”ì¶œëœ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì¡°í™”ëœ ë¦¬í¬íŠ¸ ìë™ ìƒì„±
- ğŸ”” **ì‹¤ì‹œê°„ ì•Œë¦¼**: WebSocketì„ í†µí•œ ì²˜ë¦¬ ìƒíƒœ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
- ğŸ“ˆ **ëª¨ë‹ˆí„°ë§**: Flowerë¥¼ í†µí•œ Celery ì‘ì—… ëª¨ë‹ˆí„°ë§
- ğŸ“‹ **êµ¬ì¡°í™”ëœ ë¡œê¹…**: ì¼ë³„ ë¡œê·¸ ë¡œí…Œì´ì…˜ ë° ì—ëŸ¬ ì¶”ì 
- ğŸ›¡ï¸ **ì—ëŸ¬ í•¸ë“¤ë§**: ì „ì—­ ì˜ˆì™¸ ì²˜ë¦¬ ë° í‘œì¤€í™”ëœ API ì‘ë‹µ

### í”„ë¡œë•ì…˜ ê¸°ëŠ¥
- âœ… í‘œì¤€í™”ëœ API ì‘ë‹µ í¬ë§·
- âœ… ì „ì—­ ì˜ˆì™¸ í•¸ë“¤ëŸ¬
- âœ… êµ¬ì¡°í™”ëœ ë¡œê¹… ì‹œìŠ¤í…œ (ì¼ë³„ ë¡œí…Œì´ì…˜)
- âœ… íŒŒì¼ ë‹¤ìš´ë¡œë“œ API
- âœ… ë¬¸ì„œ í†µê³„ API
- âœ… WebSocket ì‹¤ì‹œê°„ ì•Œë¦¼
- âœ… Flower ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ
- âœ… í™˜ê²½ë³€ìˆ˜ ê´€ë¦¬ (.env)
- âœ… í”„ë¡œë•ì…˜ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸

## ê¸°ìˆ  ìŠ¤íƒ

- **Framework**: FastAPI 0.115+
- **Server**: Uvicorn (ASGI)
- **ORM**: SQLAlchemy 2.0
- **Validation**: Pydantic 2.0
- **Task Queue**: Celery 5.3
- **Cache/Broker**: Redis
- **Monitoring**: Flower 2.0
- **WebSocket**: Native FastAPI WebSocket
- **Database**: SQLite3 (ê°œë°œ), PostgreSQL (í”„ë¡œë•ì…˜)
- **Authentication**: JWT (python-jose)
- **File Processing**: 
  - Excel: openpyxl
  - PDF: PyPDF2
  - Image: Pillow

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### ë‹¨ì¼ ì„œë²„ êµ¬ì„± (ê°œë°œ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     localhost                                â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚   FastAPI    â”‚      â”‚    Redis     â”‚                     â”‚
â”‚  â”‚   :8001      â”‚â—„â”€â”€â”€â”€â”€â”¤   :6379      â”‚                     â”‚
â”‚  â”‚ (Uvicorn)    â”‚      â”‚  (Broker)    â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚         â”‚                     â”‚                              â”‚
â”‚         â”‚ HTTP/JSON           â”‚ Task Queue                   â”‚
â”‚         â”‚                     â”‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚  SQLite DB   â”‚      â”‚Celery Worker â”‚                     â”‚
â”‚  â”‚ (ë¬¸ì„œ ë©”íƒ€)  â”‚      â”‚ (íŒŒì¼ ì²˜ë¦¬)  â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                               â”‚
â”‚         ğŸ“ media/documents/                                  â”‚
â”‚            (ì—…ë¡œë“œëœ íŒŒì¼)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í”„ë¡œë•ì…˜ êµ¬ì„± (Docker + ìŠ¤ì¼€ì¼ë§)

```
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   Client    â”‚
                        â”‚  (Browser)  â”‚
                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                               â”‚ HTTP
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Load Balancer   â”‚
                    â”‚    (Nginx)       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â–¼                â–¼                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  FastAPI #1  â”‚ â”‚  FastAPI #2  â”‚ â”‚  FastAPI #3  â”‚
    â”‚  (Uvicorn)   â”‚ â”‚  (Uvicorn)   â”‚ â”‚  (Uvicorn)   â”‚
    â”‚   :8001      â”‚ â”‚   :8002      â”‚ â”‚   :8003      â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                â”‚                â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚   PostgreSQL    â”‚
                   â”‚   (ë¬¸ì„œ ë©”íƒ€)   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            
                            â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â–¼                â–¼                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Redis      â”‚ â”‚ Celery Workerâ”‚      â”‚    S3 or     â”‚
    â”‚  (Broker)    â”‚â”€â”¤      #1      â”‚      â”‚  File System â”‚
    â”‚   :6379      â”‚ â”‚              â”‚      â”‚  (íŒŒì¼ ì €ì¥) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ Celery Workerâ”‚
                     â”‚      #2      â”‚
                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                     â”‚ Celery Workerâ”‚
                     â”‚      #3      â”‚
                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                     â”‚     ...      â”‚
                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                     â”‚ Celery Workerâ”‚
                     â”‚     #10      â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ìš”ì²­ ì²˜ë¦¬ í”Œë¡œìš°

```
1. íŒŒì¼ ì—…ë¡œë“œ (ë™ê¸° ë¶€ë¶„)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Client â”€HTTPâ”€> FastAPI â”€SQLâ”€> PostgreSQL
  â”‚                â”‚
  â”‚                â””â”€Save Fileâ”€> S3/FileSystem
  â”‚                â”‚
  â”‚                â””â”€Push Taskâ”€> Redis (Broker)
  â”‚                â”‚
  â””<â”€HTTP 202â”€â”€â”€â”€â”€â”˜ "ì—…ë¡œë“œ ì™„ë£Œ, ì²˜ë¦¬ ì‹œì‘"
  
  (ì—¬ê¸°ê¹Œì§€ 1-2ì´ˆ, ë¹ ë¥¸ ì‘ë‹µ)


2. ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬ (ë¹„ë™ê¸° ë¶€ë¶„)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
                   Redis â”€Taskâ”€> Celery Worker #3
                    â”‚              â”‚
                    â”‚              â”œâ”€Read File from S3
                    â”‚              â”œâ”€Extract Data (30ì´ˆ)
                    â”‚              â”œâ”€Generate Report (10ì´ˆ)
                    â”‚              â””â”€Update DB (ì™„ë£Œ ìƒíƒœ)
                    â”‚
                    â””â”€Resultâ”€> PostgreSQL
  
  (ì—¬ê¸°ëŠ” 30-60ì´ˆ, ì‚¬ìš©ìëŠ” ê¸°ë‹¤ë¦¬ì§€ ì•ŠìŒ)


3. ìƒíƒœ í™•ì¸ (í´ë§ or WebSocket)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Client â”€GET /documents/{id}â”€> FastAPI â”€> PostgreSQL
       <â”€ {"status": "completed"}â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ ìŠ¤ì¼€ì¼ë§ ì „ëµ

### ì›¹ ì„œë²„ë¥¼ ì™œ ì—¬ëŸ¬ ê°œ ë„ìš°ë‚˜?

**ì´ìœ  1: ì¥ì•  ê²©ë¦¬ (High Availability)**

```python
# ì‹œë‚˜ë¦¬ì˜¤: ì›¹ì„œë²„ 1ê°œë§Œ ì‹¤í–‰ ì¤‘
FastAPI :8001 â”€â”€â”€ ì²˜ë¦¬ ì¤‘... (5ì´ˆ ê±¸ë¦¬ëŠ” ìš”ì²­)
                  â”‚
                  â””â”€ ğŸ’¥ í¬ë˜ì‹œ! â†’ ì „ì²´ ì„œë¹„ìŠ¤ ë‹¤ìš´

# âŒ ë¬¸ì œ: ëª¨ë“  ì‚¬ìš©ìê°€ ì„œë¹„ìŠ¤ ì´ìš© ë¶ˆê°€


# ì‹œë‚˜ë¦¬ì˜¤: ì›¹ì„œë²„ 3ê°œ ì‹¤í–‰ ì¤‘
FastAPI :8001 â”€â”€â”€ ğŸ’¥ í¬ë˜ì‹œ!
FastAPI :8002 â”€â”€â”€ âœ… ì •ìƒ ì‘ë™ (ìš”ì²­ ì²˜ë¦¬)
FastAPI :8003 â”€â”€â”€ âœ… ì •ìƒ ì‘ë™ (ìš”ì²­ ì²˜ë¦¬)

# âœ… í•´ê²°: ë‚˜ë¨¸ì§€ 2ê°œê°€ ê³„ì† ì„œë¹„ìŠ¤ ì œê³µ
```ë©€í‹° í”„ë¡œì„¸ìŠ¤

**ê³µí†µì : ë‘˜ ë‹¤ ì¥ì•  ê²©ë¦¬ì™€ ë¦¬ì†ŒìŠ¤ ë¶„ì‚°ì„ ìœ„í•œ ê²ƒ**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Node.js Cluster (ë‹¨ì¼ ì„œë²„ ë‚´ ê²©ë¦¬)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚    Master Process (í¬íŠ¸ 3000 ê´€ë¦¬)                       â”‚
â”‚         â”‚                                                 â”‚
â”‚         â”œâ”€â”€> Worker 1 â”€â”€â”€ ìš”ì²­ ì²˜ë¦¬ ì¤‘                   â”‚
â”‚         â”œâ”€â”€> Worker 2 â”€â”€â”€ ğŸ’¥ í¬ë˜ì‹œ! (Masterê°€ ì¬ì‹œì‘)  â”‚
â”‚         â”œâ”€â”€> Worker 3 â”€â”€â”€ ìš”ì²­ ì²˜ë¦¬ ì¤‘                   â”‚
â”‚         â””â”€â”€> Worker 4 â”€â”€â”€ ìš”ì²­ ì²˜ë¦¬ ì¤‘                   â”‚
â”‚                                                           â”‚
â”‚    âœ… Worker í•˜ë‚˜ ì£½ì–´ë„ ë‚˜ë¨¸ì§€ 3ê°œê°€ ê³„ì† ì„œë¹„ìŠ¤       â”‚
â”‚    âœ… CPU 4ì½”ì–´ ëª¨ë‘ í™œìš©                                â”‚
â”‚    âŒ ë‹¨ì¼ ì„œë²„ í•œê³„ (ìŠ¤ì¼€ì¼ ì•„ì›ƒ ë¶ˆê°€)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FastAPI + Uvicorn (ì„œë²„ ê°„ ê²©ë¦¬ ê°€ëŠ¥)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  [ì„œë²„ 1 - AWS]         [ì„œë²„ 2 - AWS]                   â”‚
â”‚  FastAPI Ã—4             FastAPI Ã—4                        â”‚
â”‚  â””â”€ ğŸ’¥ ì„œë²„ ë‹¤ìš´        â””â”€ âœ… ì •ìƒ ì‘ë™                  â”‚
â”‚                                                           â”‚
â”‚         â–²                      â–²                          â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                    â”‚                                      â”‚
â”‚            Load Balancer (ALB)                            â”‚
â”‚                                                           â”‚
â”‚    âœ… ì„œë²„ í•˜ë‚˜ ë‹¤ìš´ë¼ë„ ë‚˜ë¨¸ì§€ê°€ ê³„ì† ì„œë¹„ìŠ¤            â”‚
â”‚    âœ… ì—¬ëŸ¬ ì„œë²„ë¡œ ë¬´í•œ í™•ì¥ ê°€ëŠ¥                          â”‚
â”‚    âœ… ê° ì„œë²„ë¥¼ ë…ë¦½ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸/ì¬ì‹œì‘ ê°€ëŠ¥          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í•µì‹¬ ì°¨ì´ì 

| êµ¬ë¶„ | Node.js Cluster | FastAPI ë©€í‹° ì¸ìŠ¤í„´ìŠ¤ |
|------|-----------------|---------------------|
| **ëª©ì ** | âœ… ì¥ì•  ê²©ë¦¬ + CPU í™œìš© | âœ… ì¥ì•  ê²©ë¦¬ + CPU í™œìš© |
| **í™•ì¥ ë²”ìœ„** | ë‹¨ì¼ ì„œë²„ ë‚´ | ì—¬ëŸ¬ ì„œë²„ë¡œ í™•ì¥ ê°€ëŠ¥ â­ |
| **í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬** | Master/Worker êµ¬ì¡° | ë…ë¦½ í”„ë¡œì„¸ìŠ¤ (ê°ì ì‚´ì•„ë‚¨ê¸°) |
| **í¬íŠ¸ ê³µìœ ** | ê°™ì€ í¬íŠ¸ ê³µìœ  | ê°ì ë‹¤ë¥¸ í¬íŠ¸ or ë¡œë“œë°¸ëŸ°ì„œ |
| **ì¥ì•  ë³µêµ¬** | Masterê°€ ìë™ ì¬ì‹œì‘ | ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ í•„ìš” (K8s, Docker) |
| **ìƒíƒœ ê³µìœ ** | í”„ë¡œì„¸ìŠ¤ ê°„ IPC ê°€ëŠ¥ | Stateless (Redisë¡œ ìƒíƒœ ê³µìœ ) |
| **ë°°í¬ ì „ëµ** | PM2, Forever | Docker, K8s, í´ë¼ìš°ë“œ |
| **ë¬´ì¤‘ë‹¨ ë°°í¬** | PM2 reload | ë¡¤ë§ ì—…ë°ì´íŠ¸ (ì„œë²„ í•˜ë‚˜ì”©) |

### ì‹¤ì „ ë¹„êµ: ì¥ì•  ìƒí™©

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ìƒí™©: ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¡œ í”„ë¡œì„¸ìŠ¤ í•˜ë‚˜ê°€ í¬ë˜ì‹œ!
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

[Node.js Cluster]
Worker 2 ğŸ’¥ í¬ë˜ì‹œ
    â†“
Masterê°€ ì¦‰ì‹œ ê°ì§€
    â†“
Worker 2 ì¬ì‹œì‘ (2ì´ˆ)
    â†“
âœ… ì„œë¹„ìŠ¤ ì •ìƒ (ë‚˜ë¨¸ì§€ Worker 1,3,4ê°€ ì²˜ë¦¬)


[FastAPI - ë‹¨ì¼ ì„œë²„]
FastAPI Instance 2 ğŸ’¥ í¬ë˜ì‹œ
    â†“
Docker/K8sê°€ ê°ì§€
    â†“
FastAPI Instance 2 ì¬ì‹œì‘ (5ì´ˆ)
    â†“
âœ… ì„œë¹„ìŠ¤ ì •ìƒ (ë‚˜ë¨¸ì§€ Instance 1,3,4ê°€ ì²˜ë¦¬)


[FastAPI - ë©€í‹° ì„œë²„] â­
Server 1 ì „ì²´ ë‹¤ìš´! ğŸ’¥
    â†“
Load Balancerê°€ ê°ì§€
    â†“
íŠ¸ë˜í”½ì„ Server 2, 3ìœ¼ë¡œë§Œ ì „ë‹¬
    â†“
âœ… ì„œë¹„ìŠ¤ ì •ìƒ (Server 2,3ê°€ ëª¨ë‘ ì²˜ë¦¬)
    â†“
Server 1 ë³µêµ¬ í›„ ìë™ìœ¼ë¡œ íŠ¸ë˜í”½ ì¬ë¶„ë°°

â†’ ì„œë²„ ì „ì²´ê°€ ë‹¤ìš´ë¼ë„ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ì—†ìŒ!
```
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì˜ˆì‹œ 1) íŠ¸ë˜í”½ ë§ìŒ, íŒŒì¼ ì²˜ë¦¬ ì ìŒ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
FastAPI Ã—10 (ì´ˆë‹¹ 10,000 ìš”ì²­ ì²˜ë¦¬)
    â†“ íƒœìŠ¤í¬ ì „ë‹¬
Celery Worker Ã—3 (íŒŒì¼ 3ê°œ ë™ì‹œ ì²˜ë¦¬)


ì˜ˆì‹œ 2) íŠ¸ë˜í”½ ì ìŒ, íŒŒì¼ ì²˜ë¦¬ ë§ìŒ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
FastAPI Ã—2 (ì´ˆë‹¹ 2,000 ìš”ì²­ ì²˜ë¦¬)
    â†“ íƒœìŠ¤í¬ ì „ë‹¬
Celery Worker Ã—20 (íŒŒì¼ 20ê°œ ë™ì‹œ ì²˜ë¦¬)


ì˜ˆì‹œ 3) ê· í˜• ì¡íŒ êµ¬ì„±
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
FastAPI Ã—5 (ì´ˆë‹¹ 5,000 ìš”ì²­ ì²˜ë¦¬)
    â†“ íƒœìŠ¤í¬ ì „ë‹¬
Celery Worker Ã—10 (íŒŒì¼ 10ê°œ ë™ì‹œ ì²˜ë¦¬)
```

### ì‹¤ì „ ì‹œë‚˜ë¦¬ì˜¤ë¡œ ì´í•´í•˜ê¸°

```
ì‹œë‚˜ë¦¬ì˜¤: ì‚¬ìš©ì 3ëª…ì´ ë™ì‹œì— íŒŒì¼ ì—…ë¡œë“œ

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1ë‹¨ê³„: HTTP ìš”ì²­ ì²˜ë¦¬ (ì›¹ì„œë²„)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[ì‚¬ìš©ìA] â”€uploadâ”€> [FastAPI #1] â”€save fileâ”€> âœ… ì™„ë£Œ (1ì´ˆ)
[ì‚¬ìš©ìB] â”€uploadâ”€> [FastAPI #2] â”€save fileâ”€> âœ… ì™„ë£Œ (1ì´ˆ)
[ì‚¬ìš©ìC] â”€uploadâ”€> [FastAPI #3] â”€save fileâ”€> âœ… ì™„ë£Œ (1ì´ˆ)

3ëª… ëª¨ë‘ 1ì´ˆ ë§Œì— ì‘ë‹µ ë°›ìŒ! ğŸ‰


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2ë‹¨ê³„: ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬ (ì›Œì»¤)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FastAPI #1 â”€push taskâ”€> Redis Queue
FastAPI #2 â”€push taskâ”€> Redis Queue
FastAPI #3 â”€push taskâ”€> Redis Queue

Redis Queue: [Task A, Task B, Task C]
                â†“
           [Celery Worker #1] â† Task A (30ì´ˆ ì²˜ë¦¬ ì¤‘)
           [Celery Worker #2] â† Task B (30ì´ˆ ì²˜ë¦¬ ì¤‘)
           [Celery Worker #3] â† ëŒ€ê¸° ì¤‘ (Task C ëŒ€ê¸°)

3ê°œ íŒŒì¼ì´ ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬ë¨


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ë§Œì•½ ì›¹ì„œë²„ê°€ 1ê°œë¿ì´ë¼ë©´?                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[ì‚¬ìš©ìA] â”€uploadâ”€> [FastAPI #1] â”€processingâ”€> âœ… ì™„ë£Œ (1ì´ˆ)
[ì‚¬ìš©ìB] â”€uploadâ”€> [FastAPI #1] â”€waiting...â”€> â±ï¸ ëŒ€ê¸°
[ì‚¬ìš©ìC] â”€uploadâ”€> [FastAPI #1] â”€waiting...â”€> â±ï¸ ëŒ€ê¸°

ì‚¬ìš©ìB, CëŠ” ì• ì‚¬ëŒì´ ëë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼! ğŸ˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ë§Œì•½ ì›Œì»¤ê°€ 10ê°œë¼ë©´?                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FastAPI #1,2,3 â”€push tasksâ”€> Redis Queue

Redis Queue: [Task A, Task B, Task C]
                â†“
           [Worker #1] â† Task A (30ì´ˆ)
           [Worker #2] â† Task B (30ì´ˆ)
           [Worker #3] â† Task C (30ì´ˆ)
           [Worker #4~#10] â† ëŒ€ê¸° ì¤‘ (ìœ íœ´)

3ê°œ íŒŒì¼ì´ ë™ì‹œì— ì²˜ë¦¬ë¨! í•˜ì§€ë§Œ Worker 7ê°œëŠ” ë†€ê³  ìˆìŒ
```

### ğŸ¯ ìµœì  êµ¬ì„± ê²°ì • ë°©ë²•

```python
# ê³µì‹:
ì›¹ì„œë²„ ê°œìˆ˜ = ì˜ˆìƒ ë™ì‹œ ì ‘ì†ì Ã· 100
ì›Œì»¤ ê°œìˆ˜ = ì˜ˆìƒ ë™ì‹œ íŒŒì¼ ì²˜ë¦¬ ê°œìˆ˜


# ì˜ˆì‹œ 1) ë¸”ë¡œê·¸ ì„œë¹„ìŠ¤
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ë™ì‹œ ì ‘ì†: 5,000ëª…
ë™ì‹œ íŒŒì¼ ì—…ë¡œë“œ: 10ê°œ

â†’ FastAPI Ã—50 (100ëª…ë‹¹ 1ê°œ)
â†’ Celery Worker Ã—15 (ì—¬ìœ  50%)


# ì˜ˆì‹œ 2) íŒŒì¼ ë³€í™˜ ì„œë¹„ìŠ¤
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ë™ì‹œ ì ‘ì†: 500ëª…
ë™ì‹œ íŒŒì¼ ì²˜ë¦¬: 200ê°œ

â†’ FastAPI Ã—5
â†’ Celery Worker Ã—300 (ì²˜ë¦¬ ì‹œê°„ ê³ ë ¤)


# ì˜ˆì‹œ 3) ìš°ë¦¬ í”„ë¡œì íŠ¸ (ë¬¸ì„œ ì²˜ë¦¬)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ë™ì‹œ ì ‘ì†: 100ëª…
ë™ì‹œ íŒŒì¼ ì²˜ë¦¬: 50ê°œ

â†’ FastAPI Ã—3-5
â†’ Celery Worker Ã—50-100
```

### Node.js í´ëŸ¬ìŠ¤í„° vs FastAPI ì›Œì»¤

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Node.js Cluster (ë‹¨ì¼ ì„œë²„)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚    Master Process                                         â”‚
â”‚         â”‚                                                 â”‚
â”‚         â”œâ”€â”€> Worker 1 (í¬íŠ¸ 3000 ê³µìœ )                   â”‚
â”‚         â”œâ”€â”€> Worker 2 (í¬íŠ¸ 3000 ê³µìœ )                   â”‚
â”‚         â”œâ”€â”€> Worker 3 (í¬íŠ¸ 3000 ê³µìœ )                   â”‚
â”‚         â””â”€â”€> Worker 4 (í¬íŠ¸ 3000 ê³µìœ )                   â”‚
â”‚                                                           â”‚
â”‚    ê°™ì€ ë¨¸ì‹ , ê°™ì€ í¬íŠ¸, í”„ë¡œì„¸ìŠ¤ ê°„ í†µì‹                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FastAPI + Uvicorn (ë¶„ì‚° ê°€ëŠ¥)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  [ì„œë²„ 1]          [ì„œë²„ 2]          [ì„œë²„ 3]            â”‚
â”‚  Uvicorn :8001     Uvicorn :8001     Uvicorn :8001       â”‚
â”‚                                                           â”‚
â”‚         â–²                â–²                â–²              â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                          â”‚                                â”‚
â”‚   âš ï¸ ìì£¼ í•˜ëŠ” ì˜¤í•´: "ì›¹ì„œë²„ 3ê°œë©´ ì›Œì»¤ë„ 3ë°°?"

**ì•„ë‹™ë‹ˆë‹¤! ì™„ì „íˆ ë…ë¦½ì ì…ë‹ˆë‹¤.**

```bash
# Docker Composeì—ì„œ ë…ë¦½ì ìœ¼ë¡œ ì„¤ì •
docker-compose up -d --scale web=5 --scale worker=10

ê²°ê³¼:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
FastAPI ì¸ìŠ¤í„´ìŠ¤: 5ê°œ
Celery Worker: 10ê°œ (5Ã—2ê°€ ì•„ë‹˜!)
Redis (Broker): 1ê°œ (ê³µìœ )
PostgreSQL: 1ê°œ (ê³µìœ )
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ëª¨ë“  FastAPI ì¸ìŠ¤í„´ìŠ¤ê°€ ê°™ì€ 10ê°œì˜ ì›Œì»¤ë¥¼ ê³µìœ í•©ë‹ˆë‹¤!
```

### ì‹œë‚˜ë¦¬ì˜¤ë³„ ìŠ¤ì¼€ì¼ë§ ì „ëµ

**ì‹œë‚˜ë¦¬ì˜¤ 1: íŠ¸ë˜í”½ ê¸‰ì¦ (ì¡°íšŒ ìš”ì²­ ë§ìŒ)**
```bash
# ë¬¸ì œ: API ì‘ë‹µì´ ëŠë ¤ì§
# ì›ì¸: FastAPI ì¸ìŠ¤í„´ìŠ¤ ë¶€ì¡±

# í•´ê²°: ì›¹ì„œë²„ë§Œ ì¦ì„¤
docker-compose up -d --scale web=10

# ê²°ê³¼: 
# âœ… HTTP ìš”ì²­ ì²˜ë¦¬ ëŠ¥ë ¥ 2ë°° í–¥ìƒ
# âœ… ì›Œì»¤ëŠ” ê·¸ëŒ€ë¡œ (íŒŒì¼ ì²˜ë¦¬ ë¶€í•˜ ì—†ìŒ)
```

**ì‹œë‚˜ë¦¬ì˜¤ 2: íŒŒì¼ ì²˜ë¦¬ ì§€ì—° (ì—…ë¡œë“œ ë§ìŒ)**
```bash
# ë¬¸ì œ: íŒŒì¼ì´ ì²˜ë¦¬ë˜ì§€ ì•Šê³  ìŒ“ì„
# ì›ì¸: Celery Worker ë¶€ì¡±

# í•´ê²°: ì›Œì»¤ë§Œ ì¦ì„¤
docker-compose up -d --scale worker=20

# ê²°ê³¼:
# âœ… ë™ì‹œ íŒŒì¼ ì²˜ë¦¬ ëŠ¥ë ¥ 6ë°° í–¥ìƒ
# âœ… ì›¹ì„œë²„ëŠ” ê·¸ëŒ€ë¡œ (API íŠ¸ë˜í”½ ì •ìƒ)
```

**ì‹œë‚˜ë¦¬ì˜¤ 3: í˜¼í•© (íŠ¸ë˜í”½ + íŒŒì¼ ëª¨ë‘ ë§ìŒ)**
```bash
# ë¬¸ì œ: APIë„ ëŠë¦¬ê³  íŒŒì¼ë„ ë°€ë¦¼
# í•´ê²°: ë‘˜ ë‹¤ ì¦ì„¤
docker-compose up -d --scale web=10 --scale worker=30

# ê²°ê³¼:
# âœ… ì›¹: 10ê°œ (ë…ë¦½ì )
# âœ… ì›Œì»¤: 30ê°œ (ë…ë¦½ì )
```

**ì‹œë‚˜ë¦¬ì˜¤ 4: ì„œë²„ ì¥ì•  ëŒ€ë¹„ (ê³ ê°€ìš©ì„±)**
```bash
# ëª©ì : ì›¹ì„œë²„ í•˜ë‚˜ ì£½ì–´ë„ ì„œë¹„ìŠ¤ ìœ ì§€
docker-compose up -d --scale web=5 --scale worker=10

# ì¥ì :
# âœ… ì›¹ì„œë²„ 1ê°œ ë‹¤ìš´ â†’ 4ê°œê°€ ê³„ì† ì„œë¹„ìŠ¤
# âœ… ì›Œì»¤ 3ê°œ ë‹¤ìš´ â†’ 7ê°œê°€ ê³„ì† ì²˜ë¦¬
# âœ… ê°œìˆ˜ë¥¼ ì¶©ë¶„íˆ í™•ë³´ (ì—¬ìœ  ìˆê²Œ)

```bash
# ë‹¨ì¼ ì„œë²„ì—ì„œ íš¨ìœ¨ì ì¸ ë©€í‹° í”„ë¡œì„¸ìŠ¤
gunicorn fastapi_app.main:app \
  --workers 8 \                    # CPU ì½”ì–´ ìˆ˜ë§Œí¼
  --worker-class uvicorn.workers.UvicornWorker \
  --bind 0.0.0.0:8000
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Gunicorn (Master)                     â”‚
â”‚    â”œâ”€ Uvicorn Worker 1 (async)         â”‚
â”‚    â”œâ”€ Uvicorn Worker 2 (async)         â”‚
â”‚    â”œâ”€ Uvicorn Worker 3 (async)         â”‚
â”‚    â””â”€ Uvicorn Worker 4 (async)         â”‚
â”‚                                         â”‚
â”‚  ê° WorkerëŠ” ë…ë¦½ ì´ë²¤íŠ¸ ë£¨í”„           â”‚
â”‚  Masterê°€ ì¬ì‹œì‘ ê´€ë¦¬                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ³ Docker Compose êµ¬ì„±

### ì™„ì „í•œ ìŠ¤íƒ ì˜ˆì‹œ

```yaml
version: '3.8'

services:
  # PostgreSQL ë°ì´í„°ë² ì´ìŠ¤
  db:
    image: postgres:15
    environment:
      POSTGRES_DB: document_api
      POSTGRES_USER: admin
      POSTGRES_PASSWORD: secret
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

  # Redis (Celery Broker)
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"

  # FastAPI ì›¹ ì„œë²„ #1
  web1:
    build: .
    command: uvicorn fastapi_app.main:app --host 0.0.0.0 --port 8001
    volumes:
      - ./media:/app/media
    environment:
      DATABASE_URL: postgresql://admin:secret@db:5432/document_api
      CELERY_BROKER_URL: redis://redis:6379/0
    depends_on:
      - db
      - redis
    ports:
      - "8001:8001"

  # FastAPI ì›¹ ì„œë²„ #2
  web2:
    build: .
    command: uvicorn fastapi_app.main:app --host 0.0.0.0 --port 8002
    volumes:
      - ./media:/app/media
    environment:
      DATABASE_URL: postgresql://admin:secret@db:5432/document_api
      CELERY_BROKER_URL: redis://redis:6379/0
    depends_on:
      - db
      - redis
    ports:
      - "8002:8002"

  # FastAPI ì›¹ ì„œë²„ #3
  web3:
    build: .
    command: uvicorn fastapi_app.main:app --host 0.0.0.0 --port 8003
    volumes:
      - ./media:/app/media
    environment:
      DATABASE_URL: postgresql://admin:secret@db:5432/document_api
      CELERY_BROKER_URL: redis://redis:6379/0
    depends_on:
      - db
      - redis
    ports:
      - "8003:8003"

  # Nginx ë¡œë“œ ë°¸ëŸ°ì„œ
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
    depends_on:
      - web1
      - web2
      - web3

  # Celery Worker #1
  worker1:
    build: .
    command: celery -A fastapi_app.tasks.celery_app worker --concurrency=4 -n worker1@%h
    volumes:
      - ./media:/app/media
    environment:
      DATABASE_URL: postgresql://admin:secret@db:5432/document_api
      CELERY_BROKER_URL: redis://redis:6379/0
    depends_on:
      - db
      - redis

  # Celery Worker #2
  worker2:
    build: .
    command: celery -A fastapi_app.tasks.celery_app worker --concurrency=4 -n worker2@%h
    volumes:
      - ./media:/app/media
    environment:
      DATABASE_URL: postgresql://admin:secret@db:5432/document_api
      CELERY_BROKER_URL: redis://redis:6379/0
    depends_on:
      - db
      - redis

  # Celery Worker #3
  worker3:
    build: .
    command: celery -A fastapi_app.tasks.celery_app worker --concurrency=4 -n worker3@%h
    volumes:
      - ./media:/app/media
    environment:
      DATABASE_URL: postgresql://admin:secret@db:5432/document_api
      CELERY_BROKER_URL: redis://redis:6379/0
    depends_on:
      - db
      - redis

  # Flower (Celery ëª¨ë‹ˆí„°ë§)
  flower:
    build: .
    command: celery -A fastapi_app.tasks.celery_app flower
    ports:
      - "5555:5555"
    environment:
      CELERY_BROKER_URL: redis://redis:6379/0
    depends_on:
      - redis

volumes:
  postgres_data:
```

### Nginx ì„¤ì • (nginx.conf)

```nginx
events {
    worker_connections 1024;
}

http {
    upstream fastapi_backend {
        # Round-robin ë¡œë“œ ë°¸ëŸ°ì‹±
        server web1:8001;
        server web2:8002;
        server web3:8003;
    }

    server {
        listen 80;
        
        location / {
            proxy_pass http://fastapi_backend;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }

        # íŒŒì¼ ì—…ë¡œë“œ í¬ê¸° ì œí•œ
        client_max_body_size 10M;
    }
}
```

## ğŸ¯ ì‹¤ì „ ìŠ¤ì¼€ì¼ë§ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: íŠ¸ë˜í”½ ê¸‰ì¦ (ì‚¬ìš©ì ìš”ì²­ ë§ìŒ)
```bash
# FastAPI ì„œë²„ ì¦ì„¤ (5ê°œ â†’ 10ê°œ)
docker-compose up -d --scale web=10

# ê²°ê³¼: HTTP ìš”ì²­ ì²˜ë¦¬ ëŠ¥ë ¥ 2ë°° í–¥ìƒ
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: íŒŒì¼ ì²˜ë¦¬ ì§€ì—° (ë°±ê·¸ë¼ìš´ë“œ ì‘ì—… ë§ìŒ)
```bash
# Celery Worker ì¦ì„¤ (3ê°œ â†’ 20ê°œ)
docker-compose up -d --scale worker=20

# ê²°ê³¼: ë™ì‹œ íŒŒì¼ ì²˜ë¦¬ ëŠ¥ë ¥ 6ë°° í–¥ìƒ
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: í˜¼í•© (ë‘˜ ë‹¤ ì¦ì„¤)
```bash
docker-compose up -d --scale web=10 --scale worker=20
```

## ğŸ“Š ì„±ëŠ¥ ë¹„êµ

| êµ¬ì„± | ì´ˆë‹¹ ìš”ì²­ | ë™ì‹œ íŒŒì¼ ì²˜ë¦¬ | ë¹„ìš© |
|------|----------|----------------|------|
| **ê°œë°œ í™˜ê²½** | | | |
| FastAPI Ã—1, Worker Ã—1 | 500 req/s | 1ê°œ | ğŸ’° |
| **ì†Œê·œëª¨ í”„ë¡œë•ì…˜** | | | |
| FastAPI Ã—3, Worker Ã—5 | 2,000 req/s | 5ê°œ | ğŸ’°ğŸ’° |
| **ì¤‘ê·œëª¨ í”„ë¡œë•ì…˜** | | | |
| FastAPI Ã—10, Worker Ã—20 | 8,000 req/s | 20ê°œ | ğŸ’°ğŸ’°ğŸ’°ğŸ’° |
| **ëŒ€ê·œëª¨ í”„ë¡œë•ì…˜** | | | |
| FastAPI Ã—50, Worker Ã—100 | 50,000 req/s | 100ê°œ | ğŸ’°ğŸ’°ğŸ’°ğŸ’°ğŸ’°ğŸ’°ğŸ’°ğŸ’° |

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
gijang/
â”œâ”€â”€ fastapi_app/           # FastAPI ì• í”Œë¦¬ì¼€ì´ì…˜
â”‚   â”œâ”€â”€ main.py           # ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜
â”‚   â”œâ”€â”€ core/             # í•µì‹¬ ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ config.py     # í™˜ê²½ ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ security.py   # JWT ë³´ì•ˆ
â”‚   â”‚   â””â”€â”€ dependencies.py # ì˜ì¡´ì„±
â”‚   â”œâ”€â”€ api/              # API ë¼ìš°í„°
â”‚   â”‚   â”œâ”€â”€ auth.py       # ì¸ì¦ API
â”‚   â”‚   â”œâ”€â”€ users.py      # ì‚¬ìš©ì API
â”‚   â”‚   â””â”€â”€ documents.py  # ë¬¸ì„œ API
â”‚   â”œâ”€â”€ models/           # SQLAlchemy ëª¨ë¸
â”‚   â”‚   â”œâ”€â”€ user.py
â”‚   â”‚   â””â”€â”€ document.py
â”‚   â”œâ”€â”€ schemas/          # Pydantic ìŠ¤í‚¤ë§ˆ
â”‚   â”‚   â”œâ”€â”€ user.py
â”‚   â”‚   â””â”€â”€ document.py
â”‚   â”œâ”€â”€ db/               # ë°ì´í„°ë² ì´ìŠ¤
â”‚   â”‚   â”œâ”€â”€ session.py    # DB ì—°ê²°
â”‚   â”‚   â””â”€â”€ base.py       # Base í´ë˜ìŠ¤
â”‚   â””â”€â”€ tasks/            # Celery íƒœìŠ¤í¬
â”‚       â”œâ”€â”€ celery_app.py
â”‚       â””â”€â”€ document_tasks.py
â”œâ”€â”€ media/                # ì—…ë¡œë“œëœ íŒŒì¼
â”œâ”€â”€ requirements-fastapi.txt
â””â”€â”€ init_db.py           # DB ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸
```

## ì„¤ì¹˜ ë° ì‹¤í–‰

### 1. ì˜ì¡´ì„± ì„¤ì¹˜

```bash
# ê°€ìƒ í™˜ê²½ í™œì„±í™”
source venv/bin/activate

# FastAPI ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements-fastapi.txt
```

### 2. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”

```bash
python init_db.py
```

---

## ğŸš€ ë¹ ë¥¸ ì‹œì‘ (ê¶Œì¥) â­ **[NEW]**

### ê°œë°œ í™˜ê²½ - í•œ ë²ˆì— ì‹œì‘í•˜ê¸°

```bash
# ëª¨ë“  ì„œë¹„ìŠ¤ í•œ ë²ˆì— ì‹œì‘ (FastAPI + Celery + Redis)
./start_dev.sh

# Flower í¬í•¨í•´ì„œ ì‹œì‘
./start_dev.sh --with-flower
# ë˜ëŠ”
./start_dev.sh -f
```

ì´ ëª…ë ¹ í•˜ë‚˜ë¡œ ë‹¤ìŒì´ ëª¨ë‘ ìë™ ì‹¤í–‰ë©ë‹ˆë‹¤:
- âœ… Redis ì²´í¬ ë° ì‹œì‘
- âœ… ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” (ìµœì´ˆ 1íšŒ)
- âœ… FastAPI ì„œë²„ (í¬íŠ¸ 8001)
- âœ… Celery Worker
- âœ… Flower ëª¨ë‹ˆí„°ë§ (ì„ íƒ ì‹œ)

### ì„œë¹„ìŠ¤ ê´€ë¦¬

```bash
# ì¢…ë£Œ
./stop_dev.sh

# ì¬ì‹œì‘
./restart_dev.sh

# ì‹¤ì‹œê°„ ë¡œê·¸ í™•ì¸ (ì»¬ëŸ¬ ì¶œë ¥)
./logs_dev.sh

# ê°œë³„ ë¡œê·¸ í™•ì¸
tail -f logs/fastapi.log   # FastAPI
tail -f logs/celery.log    # Celery
tail -f logs/flower.log    # Flower
```

### ì ‘ì† ì£¼ì†Œ

- ğŸŒ **API ì„œë²„**: http://localhost:8001
- ğŸ“š **API ë¬¸ì„œ**: http://localhost:8001/docs
- ğŸ“– **ReDoc**: http://localhost:8001/redoc
- ğŸŒ¸ **Flower** (ì„ íƒ): http://localhost:5555 (admin/password123)

---

## ìˆ˜ë™ ì‹¤í–‰ (ê°œë³„ ì„œë¹„ìŠ¤)

ê°œë³„ì ìœ¼ë¡œ ì‹¤í–‰í•˜ê³  ì‹¶ì„ ë•Œë§Œ ì‚¬ìš©í•˜ì„¸ìš”.

### 3. FastAPI ì„œë²„ ì‹¤í–‰

```bash
# ê°œë°œ ëª¨ë“œ (ìë™ ë¦¬ë¡œë“œ)
python -m uvicorn fastapi_app.main:app --reload --port 8001

# í”„ë¡œë•ì…˜ ëª¨ë“œ
python -m uvicorn fastapi_app.main:app --host 0.0.0.0 --port 8001 --workers 4
```

### 4. Celery Worker ì‹¤í–‰ (ë³„ë„ í„°ë¯¸ë„)

```bash
# Redis ì‹¤í–‰
redis-server

# Celery worker ì‹¤í–‰
celery -A fastapi_app.tasks.celery_app worker --loglevel=info
```

### 5. Flower ëª¨ë‹ˆí„°ë§ ì‹¤í–‰ (ì„ íƒì‚¬í•­)

```bash
./start_flower.sh
# ë˜ëŠ”
celery -A fastapi_app.tasks.celery_app flower --port=5555 --basic_auth=admin:password123
```

ì ‘ì†: http://localhost:5555 (admin/password123)

---

## ğŸš€ í”„ë¡œë•ì…˜ ì‹¤í–‰ â­ **[NEW]**

### ìë™ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸

```bash
# ëª¨ë“  ì„œë¹„ìŠ¤ í•œ ë²ˆì— ì‹œì‘
./start_production.sh
```

ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” ë‹¤ìŒì„ ìë™ìœ¼ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤:
- FastAPI ì„œë²„ (4 workers)
- Celery Worker (4 concurrency)
- Flower ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ

### ì„œë¹„ìŠ¤ ì¢…ë£Œ

```bash
./stop.sh
```

### ìˆ˜ë™ ì‹¤í–‰

```bash
# FastAPI (ë©€í‹° ì›Œì»¤)
uvicorn fastapi_app.main:app --host 0.0.0.0 --port 8001 --workers 4

# Celery Worker
celery -A fastapi_app.tasks.celery_app worker --loglevel=info --concurrency=4

# Flower ëª¨ë‹ˆí„°ë§
celery -A fastapi_app.tasks.celery_app flower --port=5555
```

### í”„ë¡œë•ì…˜ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] `.env` íŒŒì¼ì—ì„œ `SECRET_KEY` ë³€ê²½ (`openssl rand -hex 32`)
- [ ] `DEBUG=False` ì„¤ì •
- [ ] CORS í—ˆìš© ë„ë©”ì¸ ì„¤ì •
- [ ] PostgreSQLë¡œ ë°ì´í„°ë² ì´ìŠ¤ ë³€ê²½
- [ ] Redis ë³´ì•ˆ ì„¤ì • (ë¹„ë°€ë²ˆí˜¸)
- [ ] ë¡œê·¸ ë¡œí…Œì´ì…˜ í™•ì¸
- [ ] Flower ì¸ì¦ ì •ë³´ ë³€ê²½
- [ ] íŒŒì¼ ì—…ë¡œë“œ í¬ê¸° ì œí•œ ì„¤ì •
- [ ] SSL/TLS ì¸ì¦ì„œ ì„¤ì •

---

## API ì‚¬ìš©ë²•

### ğŸŒ ì„œë²„ ì£¼ì†Œ

- **API ì„œë²„**: http://localhost:8001
- **Swagger UI**: http://localhost:8001/docs
- **ReDoc**: http://localhost:8001/redoc
- **OpenAPI Schema**: http://localhost:8001/openapi.json

### ğŸ”‘ ì¸ì¦ í”Œë¡œìš°

#### 1. ì‚¬ìš©ì ë“±ë¡

```bash
curl -X POST "http://localhost:8001/api/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "email": "test@example.com",
    "password": "password123"
  }'
```

#### 2. ë¡œê·¸ì¸

```bash
curl -X POST "http://localhost:8001/api/auth/login" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=testuser&password=password123"
```

**ì‘ë‹µ:**
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer"
}
```

#### 3. ì¸ì¦ëœ ìš”ì²­

```bash
curl -X GET "http://localhost:8001/api/users/me" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

### ğŸ“¤ íŒŒì¼ ì—…ë¡œë“œ

```bash
curl -X POST "http://localhost:8001/api/documents/upload" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
  -F "file=@/path/to/document.xlsx" \
  -F "file_type=excel"
```

### ğŸ“Š ë¬¸ì„œ ì¡°íšŒ

```bash
# ë¬¸ì„œ ëª©ë¡
curl -X GET "http://localhost:8001/api/documents/" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"

# íŠ¹ì • ë¬¸ì„œ
curl -X GET "http://localhost:8001/api/documents/{document_id}" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"

# ì¶”ì¶œëœ ë°ì´í„°
curl -X GET "http://localhost:8001/api/documents/{document_id}/extracted-data" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

## API ì—”ë“œí¬ì¸íŠ¸

### ì¸ì¦ (Authentication)
- `POST /api/auth/register` - ì‚¬ìš©ì ë“±ë¡
- `POST /api/auth/login` - ë¡œê·¸ì¸ (í† í° ë°œê¸‰)

### ì‚¬ìš©ì (Users)
- `GET /api/users/me` - í˜„ì¬ ì‚¬ìš©ì ì •ë³´
- `PUT /api/users/profile` - í”„ë¡œí•„ ì—…ë°ì´íŠ¸
- `GET /api/users/{user_id}` - íŠ¹ì • ì‚¬ìš©ì ì¡°íšŒ

### ë¬¸ì„œ (Documents)
- `POST /api/documents/upload` - íŒŒì¼ ì—…ë¡œë“œ
- `GET /api/documents/` - ë¬¸ì„œ ëª©ë¡ (í˜ì´ì§•, í•„í„°ë§)
- `GET /api/documents/{id}` - ë¬¸ì„œ ìƒì„¸
- `DELETE /api/documents/{id}` - ë¬¸ì„œ ì‚­ì œ
- `POST /api/documents/{id}/reprocess` - ë¬¸ì„œ ì¬ì²˜ë¦¬
- `GET /api/documents/{id}/extracted-data` - ì¶”ì¶œëœ ë°ì´í„°
- `GET /api/documents/{id}/reports` - ë¦¬í¬íŠ¸ ëª©ë¡
- **`GET /api/documents/{id}/download`** â­ **[NEW]** - ì›ë³¸ íŒŒì¼ ë‹¤ìš´ë¡œë“œ
- **`GET /api/documents/stats/summary`** â­ **[NEW]** - ë¬¸ì„œ í†µê³„

### WebSocket
- **`WS /ws?token={jwt_token}`** â­ **[NEW]** - ì‹¤ì‹œê°„ ì•Œë¦¼ ì—°ê²°

### API ì‘ë‹µ í˜•ì‹ â­ **[NEW]**

ëª¨ë“  APIëŠ” í‘œì¤€í™”ëœ ì‘ë‹µ í˜•ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:

**ì„±ê³µ ì‘ë‹µ**:
```json
{
  "success": true,
  "message": "ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤",
  "data": { }
}
```

**ì—ëŸ¬ ì‘ë‹µ**:
```json
{
  "success": false,
  "message": "ì˜¤ë¥˜ ë©”ì‹œì§€",
  "error_code": "ERROR_CODE",
  "details": null
}
```

**í˜ì´ì§€ë„¤ì´ì…˜ ì‘ë‹µ**:
```json
{
  "success": true,
  "message": "ì¡°íšŒ ì„±ê³µ",
  "data": [],
  "total": 100,
  "page": 1,
  "page_size": 10,
  "total_pages": 10
}
```

## Django vs FastAPI ë¹„êµ

| íŠ¹ì§• | Django REST Framework | FastAPI |
|------|----------------------|---------|
| **ì„±ëŠ¥** | Sync (ëŠë¦¼) | Async (5-10ë°° ë¹ ë¦„) |
| **API ë¬¸ì„œ** | drf-spectacular í•„ìš” | ìë™ ìƒì„± |
| **íƒ€ì… ê²€ì¦** | ì‹œë¦¬ì–¼ë¼ì´ì € ìˆ˜ë™ ì‘ì„± | Pydantic ìë™ ê²€ì¦ |
| **ë¹„ë™ê¸° ì§€ì›** | ì œí•œì  | ë„¤ì´í‹°ë¸Œ ì§€ì› |
| **í•™ìŠµ ê³¡ì„ ** | ë†’ìŒ | ë‚®ìŒ |
| **Admin íŒ¨ë„** | ë‚´ì¥ | ì—†ìŒ (ë³„ë„ êµ¬í˜„) |

## ì„±ëŠ¥ ìµœì í™”

### Async/Await íŒ¨í„´

```python
@router.get("/")
async def list_documents(
    skip: int = 0,
    limit: int = 20,
    db: Session = Depends(get_db)
):
    # ë¹„ë™ê¸°ë¡œ ë™ì‹œ ìš”ì²­ ì²˜ë¦¬
    documents = await get_documents_async(db, skip, limit)
    return documents
```

### ì—°ê²° í’€ë§

```python
# SQLAlchemy ì—”ì§„ ì„¤ì •
engine = create_engine(
    DATABASE_URL,
    pool_size=20,
    max_overflow=40,
    pool_pre_ping=True
)
```

## í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

`.env` íŒŒì¼ ìƒì„±:

```env
# ë°ì´í„°ë² ì´ìŠ¤
DATABASE_URL=sqlite:///./fastapi_db.sqlite3

# JWT
SECRET_KEY=your-secret-key-change-in-production
ACCESS_TOKEN_EXPIRE_MINUTES=60

# Celery
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# íŒŒì¼ ì—…ë¡œë“œ
MAX_UPLOAD_SIZE=10485760
UPLOAD_DIR=media/documents
```

---

## ğŸ“Š ë¡œê¹… ë° ëª¨ë‹ˆí„°ë§ â­ **[NEW]**

### ë¡œê·¸ íŒŒì¼ êµ¬ì¡°

ì‹œìŠ¤í…œì€ ìë™ìœ¼ë¡œ êµ¬ì¡°í™”ëœ ë¡œê·¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤:

```
logs/
â”œâ”€â”€ app.log           # ì¼ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ (ì¼ë³„ ë¡œí…Œì´ì…˜)
â”œâ”€â”€ error.log         # ì—ëŸ¬ ë¡œê·¸ (í¬ê¸° ê¸°ë°˜ ë¡œí…Œì´ì…˜, 10MB)
â”œâ”€â”€ celery.log        # Celery ì‘ì—… ë¡œê·¸
â””â”€â”€ access.log        # API ì ‘ê·¼ ë¡œê·¸
```

### ë¡œê·¸ í™•ì¸

```bash
# ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§
tail -f logs/app.log

# ì—ëŸ¬ ë¡œê·¸ë§Œ í™•ì¸
tail -f logs/error.log

# Celery ì‘ì—… ë¡œê·¸
tail -f logs/celery.log
```

### Flower ëª¨ë‹ˆí„°ë§

FlowerëŠ” Celery ì‘ì—…ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤:

```
http://localhost:5555
```

**ê¸°ëŠ¥**:
- ì‹¤ì‹œê°„ ì‘ì—… ìƒíƒœ í™•ì¸
- ì‘ì—… ì„±ê³µ/ì‹¤íŒ¨ í†µê³„
- Worker ìƒíƒœ ëª¨ë‹ˆí„°ë§
- ì‘ì—… ì¬ì‹œì‘ ë° ì·¨ì†Œ
- ì‘ì—… ì‹¤í–‰ ì‹œê°„ ê·¸ë˜í”„

### API ì‘ë‹µ ì‹œê°„ ëª¨ë‹ˆí„°ë§

ë¡œê·¸ì—ì„œ ì‘ë‹µ ì‹œê°„ì„ í™•ì¸:

```bash
grep "GET /api" logs/access.log | awk '{print $NF}' | sort -n
```

### WebSocket ì—°ê²° ìƒíƒœ â­ **[NEW]**

WebSocketì„ í†µí•´ ì‹¤ì‹œê°„ìœ¼ë¡œ ì‘ì—… ìƒíƒœë¥¼ ë°›ìŠµë‹ˆë‹¤:

**JavaScript í´ë¼ì´ì–¸íŠ¸ ì˜ˆì œ**:
```javascript
const token = "your-jwt-token";
const ws = new WebSocket(`ws://localhost:8001/ws?token=${token}`);

ws.onmessage = (event) => {
    const data = JSON.parse(event.data);
    console.log("ì•Œë¦¼:", data);
    
    if (data.type === "document_processing") {
        updateProgress(data.document_id, data.status);
    }
};
```

**Python í´ë¼ì´ì–¸íŠ¸ ì˜ˆì œ**:
```python
import websockets
import asyncio

async def listen_notifications(token):
    uri = f"ws://localhost:8001/ws?token={token}"
    async with websockets.connect(uri) as websocket:
        while True:
            message = await websocket.recv()
            print(f"ì•Œë¦¼ ìˆ˜ì‹ : {message}")

asyncio.run(listen_notifications("your-jwt-token"))
```

---

## ê°œë°œ íŒ

### 1. Swagger UIì—ì„œ í…ŒìŠ¤íŠ¸

`http://localhost:8001/docs`ì—ì„œ ëª¨ë“  APIë¥¼ ë°”ë¡œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

### 2. ìë™ ë¦¬ë¡œë“œ

ê°œë°œ ì¤‘ì—ëŠ” `--reload` ì˜µì…˜ìœ¼ë¡œ ì½”ë“œ ë³€ê²½ ì‹œ ìë™ ì¬ì‹œì‘ë©ë‹ˆë‹¤.

### 3. íƒ€ì… íŒíŒ… í™œìš©

```python
# IDEê°€ ìë™ìœ¼ë¡œ íƒ€ì… ì²´í¬
async def get_user(user_id: int) -> UserResponse:
    # íƒ€ì… ì•ˆì „ì„± ë³´ì¥
    pass
```

### 4. ë¡œê·¸ í™•ì¸ â­ **[NEW]**

```bash
# ì‹¤ì‹œê°„ ë¡œê·¸ í™•ì¸
tail -f logs/app.log        # ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸
tail -f logs/error.log      # ì—ëŸ¬ ë¡œê·¸
tail -f logs/celery.log     # Celery ì‘ì—… ë¡œê·¸
tail -f logs/access.log     # HTTP ì•¡ì„¸ìŠ¤ ë¡œê·¸
```

### 5. WebSocket í…ŒìŠ¤íŠ¸ â­ **[NEW]**

**JavaScript í´ë¼ì´ì–¸íŠ¸ ì˜ˆì œ**:
```javascript
// 1. í† í° íšë“
const loginResponse = await fetch('http://localhost:8001/api/auth/login', {
  method: 'POST',
  headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
  body: 'username=testuser&password=testpass123'
});
const { access_token } = await loginResponse.json();

// 2. WebSocket ì—°ê²°
const ws = new WebSocket(`ws://localhost:8001/ws?token=${access_token}`);

ws.onmessage = (event) => {
  const message = JSON.parse(event.data);
  console.log('ë©”ì‹œì§€ ìˆ˜ì‹ :', message);
  
  // ë¬¸ì„œ ì²˜ë¦¬ ì™„ë£Œ ì•Œë¦¼ ì˜ˆì‹œ
  if (message.type === 'document_completed') {
    console.log(`ë¬¸ì„œ ${message.document_id} ì²˜ë¦¬ ì™„ë£Œ!`);
  }
};

ws.onopen = () => console.log('WebSocket ì—°ê²° ì„±ê³µ');
ws.onerror = (error) => console.error('WebSocket ì˜¤ë¥˜:', error);
ws.onclose = () => console.log('WebSocket ì—°ê²° ì¢…ë£Œ');
```

### 6. Flower ëª¨ë‹ˆí„°ë§ í™œìš© â­ **[NEW]**

Flower ëŒ€ì‹œë³´ë“œ (http://localhost:5555)ì—ì„œ ë‹¤ìŒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- ì‹¤ì‹œê°„ ì‘ì—… ì§„í–‰ ìƒí™©
- ì™„ë£Œ/ì‹¤íŒ¨í•œ ì‘ì—… í†µê³„
- ì›Œì»¤ ìƒíƒœ ë° CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
- ì‘ì—… ê²°ê³¼ ë° ì—ëŸ¬ íŠ¸ë ˆì´ìŠ¤
- ì‘ì—… í ìƒíƒœ

## í…ŒìŠ¤íŠ¸

```bash
# í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (pytest ì„¤ì¹˜ í•„ìš”)
pip install pytest pytest-asyncio httpx
pytest tests/
```

## í”„ë¡œë•ì…˜ ë°°í¬

### Gunicorn + Uvicorn Workers

```bash
gunicorn fastapi_app.main:app \
  --workers 4 \
  --worker-class uvicorn.workers.UvicornWorker \
  --bind 0.0.0.0:8001
```

### Docker

```dockerfile
FROM python:3.9
WORKDIR /app
COPY requirements-fastapi.txt .
RUN pip install -r requirements-fastapi.txt
COPY . .
CMD ["uvicorn", "fastapi_app.main:app", "--host", "0.0.0.0", "--port", "8001"]
```

## ëª¨ë‹ˆí„°ë§

### í—¬ìŠ¤ ì²´í¬

```bash
curl http://localhost:8001/health
```

### ë©”íŠ¸ë¦­ìŠ¤

Prometheus, Grafana ì—°ë™ ê°€ëŠ¥ (ì¶”ê°€ ì„¤ì • í•„ìš”)

## ë‹¤ìŒ ë‹¨ê³„

- [ ] ë¹„ë™ê¸° íŒŒì¼ ì—…ë¡œë“œ (aiofiles í™œìš©)
- [ ] WebSocket ì§€ì› (ì‹¤ì‹œê°„ ì²˜ë¦¬ ìƒíƒœ)
- [ ] GraphQL API ì¶”ê°€
- [ ] Admin ëŒ€ì‹œë³´ë“œ êµ¬í˜„
- [ ] ìºì‹± ë ˆì´ì–´ ì¶”ê°€ (Redis)
- [ ] Rate Limiting
- [ ] API ë²„ì „ ê´€ë¦¬

## ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” ë‚´ë¶€ ì‚¬ìš©ì„ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤.

---

## ğŸ‰ FastAPI ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ!

Djangoì—ì„œ FastAPIë¡œ ì„±ê³µì ìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ë” ë¹ ë¥´ê³ , ë” í˜„ëŒ€ì ì´ë©°, ë” íƒ€ì… ì•ˆì „í•œ APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!
